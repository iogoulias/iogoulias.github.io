<html><head>
  
  </head><body>
     <script type="text/javascript">
//      var url_string = location.href
//      var url = new URL(url_string);
//      var song = url.searchParams.get("song");
 //     var audio = document.getElementById('audio');
//var source = document.createElement('source');

//source.setAttribute('src', song);

//audio.appendChild(source);
function searchAirtable(searchTerm) {
  fetch("https://api.airtable.com/v0/app6GHxtqv6bp7oBk/tracks?api_key=keyjBiRLhAGxVa5J9&filterByFormula="+encodeURIComponent('OR(SEARCH("'+searchTerm+'",{Track Name})>0,SEARCH("'+searchTerm+'",Artist)>0,SEARCH("'+searchTerm+'",Album)>0)'))
    .then((res) => res.json())
    .then((data) => {
      //setRecipes(data.records);
      console.log(data);
     var ul=[];
      for (var i=0;i<data.records.length;i++) {
       var lientry="<li>"
      for (var key in data.records[i]["fields"]) {
      lientry=lientry+" <b>"+key+"</b>: "+data.records[i]["fields"][key];
      }
        lientry=lientry+"<button onclick=\"play('"+data.records[i]["fields"]["File ID"]+"')\">Play</button>"+"</li>";
        ul.push(lientry);
      }
    
    var audio = document.getElementById('container');
    audio.innerHTML="<ul>"+ul.join("")+"</ul>";
    
    })
    .catch((error) => {
      console.log(error);
    });
}
function search() {
var input = document.getElementById('input').value;
searchAirtable(input);
}
function play(id) {
  try {
var oldsource = document.getElementById('source').remove();
  } catch (e) {}
var audio = document.getElementById('audio');
var source = document.createElement('source');
source.setAttribute('src', "https://docs.google.com/uc?export=download&id="+id);
source.setAttribute('id', "source");
audio.appendChild(source);
document.getElementById("audio").load()
}
    </script>
  <h1>test</h1>
  <input id="input"></input>
  <button onclick="search()">Search</button>
  <audio id="audio"><source src="https://docs.google.com/uc?export=download&amp;id=1kVzNfbHfhSjwRHbEckQjclfzHFqcuL7G" id="source"></audio>

  <div id="container"></div>
  </body></html>
